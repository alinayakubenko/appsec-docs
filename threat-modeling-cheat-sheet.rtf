{\rtf1\ansi\ansicpg1252\cocoartf1671\cocoasubrtf500
{\fonttbl\f0\fnil\fcharset0 Cambria-Bold;\f1\froman\fcharset0 TimesNewRomanPS-BoldMT;\f2\fnil\fcharset0 Cambria;
\f3\froman\fcharset0 TimesNewRomanPSMT;\f4\fswiss\fcharset0 Helvetica;\f5\ftech\fcharset77 Symbol;
}
{\colortbl;\red255\green255\blue255;}
{\*\expandedcolortbl;;}
{\*\listtable{\list\listtemplateid1\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{disc\}}{\leveltext\leveltemplateid1\'01\uc0\u8226 ;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid1}
{\list\listtemplateid2\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{disc\}}{\leveltext\leveltemplateid101\'01\uc0\u8226 ;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid2}
{\list\listtemplateid3\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{disc\}}{\leveltext\leveltemplateid201\'01\uc0\u8226 ;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid3}
{\list\listtemplateid4\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{disc\}}{\leveltext\leveltemplateid301\'01\uc0\u8226 ;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid4}
{\list\listtemplateid5\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{disc\}}{\leveltext\leveltemplateid401\'01\uc0\u8226 ;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid5}
{\list\listtemplateid6\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{disc\}}{\leveltext\leveltemplateid501\'01\uc0\u8226 ;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid6}}
{\*\listoverridetable{\listoverride\listid1\listoverridecount0\ls1}{\listoverride\listid2\listoverridecount0\ls2}{\listoverride\listid3\listoverridecount0\ls3}{\listoverride\listid4\listoverridecount0\ls4}{\listoverride\listid5\listoverridecount0\ls5}{\listoverride\listid6\listoverridecount0\ls6}}
{\info
{\author Microsoft Office User}}\paperw12240\paperh15840\vieww12540\viewh13460\viewkind1
\deftab720
\pard\pardeftab720\ri0\qc\partightenfactor0

\f0\b\fs36 \cf0 Threat Modelling (TM)
\f1 .
\f0  Csheat sheet
\f1 \
\pard\pardeftab720\ri0\qc\partightenfactor0

\fs28 \cf0 \
\
\pard\pardeftab720\ri0\partightenfactor0

\f0\fs36 \cf0 Questions to ask during TM:\
\pard\pardeftab720\ri0\partightenfactor0

\f2\b0\fs28 \cf0 What are we building?\
What can go wrong?\
What should we do about those things that can go wrong?\
Did we do a decent job analysis?
\f3 \
\

\f2 We analyse 
\f0\b\fs36 software as a system
\f2\b0\fs28 . 
\f3 \

\f2 Dataflow, trust boundaries (anywhere the privileges are different), etc.
\f3 \
\

\f2 All external processes considered untrusted.
\f3 \
\

\f2 The mnemonic we use to search for possible threats is 
\f0\b\fs36 STRIDE
\f1\fs28 \
\
\pard\pardeftab720\ri0\partightenfactor0

\f0 \cf0 Spoofing
\f2\b0  \'96 Pretending to be something or someone you are not. Authentication threat.
\f3 \

\f0\b Tampering
\f2\b0  \'96 is modifying something you\'92re not suppose to modify. Including packets on the network, bits in disk or memory, etc.\

\f0\b Repudiation
\f2\b0  \'96 claiming you didn\'92t do something.\

\f0\b Information Disclosure
\f2\b0  \'96 exposing information to those who are not authorized to see it.\

\f0\b Denial of Service
\f2\b0  \'96 prevent a system from providing service.\

\f0\b Elevation of Privilege
\f2\b0  \'96 when program or user is able to do things that they\'92re not supposed to do.
\f3 \
\
\
\pard\pardeftab720\ri0\partightenfactor0

\f0\b\fs36 \cf0 STRIDE threat examples (internal API specific)\
\
\pard\pardeftab720\ri0\partightenfactor0

\fs32 \cf0 Spoofing
\f1 \
\
\pard\pardeftab720\li720\fi-360\ri0\partightenfactor0
\ls1\ilvl0
\f4\b0\fs28 \cf0 \uc0\u61623 
\f5 	
\f2 Spoofing a machine (IP, ARP, DB, process spoofing, etc)\
\ls1\ilvl0
\f4 \uc0\u61623 
\f5 	
\f2 Database is spoofed and service writes/reads data from the wrong place.\
\ls1\ilvl0
\f4 \uc0\u61623 
\f5 	
\f2 Consuming process is spoofed and sends wrong data or reads data that it\'92s not authorised to read.  
\f3 \
\ls1\ilvl0
\f4 \uc0\u61623 
\f5 	
\f2 Provider\'92s process is spoofed and can send (respond) the wrong data or misuse the data it receives. 
\f3 \
\ls1\ilvl0
\f4 \uc0\u61623 
\f5 	
\f2 A program could pretend to be a legit consumer and try to read data from the storage.
\f3 \
\ls1\ilvl0
\f4 \uc0\u61623 
\f5 	
\f2 Someone could find credentials or keys stored in a world readable file.\
\ls1\ilvl0
\f4 \uc0\u61623 
\f5 	
\f2 Someone who gets a password or token can reuse it.
\f3 \
\pard\pardeftab720\ri0\partightenfactor0

\fs32 \cf0 \
\pard\pardeftab720\ri0\partightenfactor0

\f0\b \cf0 Tampering\
\pard\pardeftab720\ri0\partightenfactor0

\f3\b0 \cf0 \
\pard\pardeftab720\li720\fi-360\ri0\partightenfactor0
\ls2\ilvl0
\f4\fs28 \cf0 \uc0\u61623 
\f5 	
\f2 Tampering with the file (external configurations and other resources). Someone can spoof someone\'92s identity and modify the file.
\f3 \
\ls2\ilvl0
\f4 \uc0\u61623 
\f5 	
\f2 Tampering with the memory, for example the malicious code is running as the same user, on the same environment. Or by modification of the data sent to API (send data by value rather that by reference when crossing the trust boundary), etc.
\f3 \
\ls2\ilvl0
\f4 \uc0\u61623 
\f5 	
\f2 Tampering with the network, like modification data in transit, etc.
\f3 \
\ls2\ilvl0
\f4 \uc0\u61623 
\f5 	
\f2 Code doesn\'92t provide timestamps.\
\ls2\ilvl0
\f4 \uc0\u61623 
\f5 	
\f2 It\'92s possible to write to the data store the code relies on.
\f3 \
\pard\pardeftab720\ri0\partightenfactor0

\fs32 \cf0 \
\pard\pardeftab720\ri0\partightenfactor0

\f0\b \cf0 Repudiation threats\
\pard\pardeftab720\ri0\partightenfactor0

\f3\b0 \cf0 \
\pard\pardeftab720\ri0\partightenfactor0

\f2\fs28 \cf0 Usually appear on the business logic layer and tied to the logging process.
\f3 \
\
\pard\pardeftab720\li720\fi-360\ri0\partightenfactor0
\ls3\ilvl0
\f4 \cf0 \uc0\u61623 
\f5 	
\f2 Repudiation in action when transaction or consumer call is not logged properly, so there is not way to make sure something has happened. Or notification wasn\'92t logged so there is no evidence it was sent, etc. 
\f3 \
\ls3\ilvl0
\f4 \uc0\u61623 
\f5 	
\f2 Attacking the logs when someone can notice there are no logs, or if it\'92s possible to insert false information into the logs to create a confusion and there is no validation, etc.
\f3 \
\ls3\ilvl0
\f4 \uc0\u61623 
\f5 	
\f2 It\'92s possible to create a log without timestamp.\
\ls3\ilvl0
\f4 \uc0\u61623 
\f5 	
\f2 Suspicious activity in the logs is not monitored properly.\
\pard\pardeftab720\li720\ri0\partightenfactor0

\f3 \cf0 \
\pard\pardeftab720\ri0\partightenfactor0
\cf0 \
\pard\pardeftab720\ri0\partightenfactor0

\f0\b\fs32 \cf0 Information Disclosure treats
\f1 \
\
\pard\pardeftab720\li720\fi-360\ri0\partightenfactor0
\ls4\ilvl0
\f4\b0\fs28 \cf0 \uc0\u61623 
\f5 	
\f2 Information disclosure against the process, when it\'92s possible to extract secrets from the error messages. Including information that could potentially be used for malicious purpose, design details, database connection info, passwords, rules etc. Or it\'92s possible to extract machine, user or business secrets from the error cases. \
\ls4\ilvl0
\f4 \uc0\u61623 
\f5 	
\f2 Information disclosure against the data store. Some examples are possibilities to use inappropriate ACL, bad DB permissions, find crypto keys stored somewhere openly, informative filenames. Code/command injections. Verbose or unprotected logs.
\f3\fs32 \
\ls4\ilvl0
\f4\fs28 \uc0\u61623 
\f5 	
\f2 Documentation that stored publicly or could be accessed by random people could be leaked as well.\
\ls4\ilvl0
\f4 \uc0\u61623 
\f5 	
\f2 Information disclosure against a data flow (analysing the traffic due to weak authentication (\'93man in the middle), no encryption, etc).\
\pard\pardeftab720\ri0\partightenfactor0

\f3\fs24 \cf0 \
\pard\pardeftab720\ri0\partightenfactor0

\f0\b\fs32 \cf0 Denial-of-service threats\
\
\pard\pardeftab720\li720\fi-360\ri0\partightenfactor0
\ls5\ilvl0
\f4\b0\fs28 \cf0 \uc0\u61623 
\f5 	
\f2 Denial-of-service against a process when the attacker absorbs the resources.\
\ls5\ilvl0
\f4 \uc0\u61623 
\f5 	
\f2 Denial-of-service against a data store when the attacker can fill the data store up or can slow down the system or even bring it down by making many requests. Logs could be filled up as well.
\f3 \
\ls5\ilvl0
\f4 \uc0\u61623 
\f5 	
\f2 Denial-of-service against a data flow by consuming network resources.
\f3 \
\pard\pardeftab720\ri0\partightenfactor0

\fs32 \cf0 \
\pard\pardeftab720\ri0\partightenfactor0

\f0\b \cf0 Elevation of Privilege threat\
\pard\pardeftab720\ri0\partightenfactor0

\f3\b0 \cf0 \
\pard\pardeftab720\li720\fi-360\ri0\partightenfactor0
\ls6\ilvl0
\f4\fs28 \cf0 \uc0\u61623 
\f5 	
\f2 Elevation of Privilege by corrupting the process (send input that code can\'92t properly handle, gain access to read/write memory).\
\ls6\ilvl0
\f4 \uc0\u61623 
\f5 	
\f2 Elevation of Privilege though missing or buggy authorization checks, including external configurations, secret storages, etc.
\f3 \
\ls6\ilvl0
\f4 \uc0\u61623 
\f5 	
\f2 Elevation through data tampering
\f3 .\
\pard\pardeftab720\ri0\partightenfactor0
\cf0 \
\pard\pardeftab720\ri0\partightenfactor0

\fs32 \cf0 \
}